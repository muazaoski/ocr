version: '3.8'

services:
  ocr-api:
    build: .
    container_name: ocr-api
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      - HOST=0.0.0.0
      - PORT=8000
      - DEBUG=false
      - SECRET_KEY=${SECRET_KEY:-change-this-in-production}
      - ADMIN_USERNAME=${ADMIN_USERNAME:-admin}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-change-this-password}
      - TESSERACT_CMD=tesseract
      - RATE_LIMIT_PER_MINUTE=60
      - RATE_LIMIT_PER_DAY=1000
      - MAX_FILE_SIZE_MB=10
      - ADMIN_PATH=${ADMIN_PATH:-admin}
      - ALLOWED_LANGUAGES=${ALLOWED_LANGUAGES:-eng,fra,deu,spa,ita,por,nld,pol,rus,jpn,chi_sim,chi_tra,kor,ara,ind}
      # Qwen3-VL Configuration (runs on host, not in container)
      - VLM_SERVER_URL=http://172.17.0.1:8081
      - VLM_TIMEOUT=120
    extra_hosts:
      - "host.docker.internal:host-gateway"
    volumes:
      - ocr-data:/app/data

volumes:
  ocr-data:
    driver: local
